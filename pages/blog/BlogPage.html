<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INFO Blog</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />


    <link rel="stylesheet" href="../../css/main.css">
    <link rel="stylesheet" href="./blog.css">
    <link rel="stylesheet" href="./feed.css">

    
</head>
<body id="blogPage" class="center-flex">
    <header id="infoblogHeader" role="banner">
        <a id="logo" class="center-flex"
        href="../../home.html">
            <img id="evolution" src="../../src/imagens/informagem-evolution/informagem-evolution-m.png" alt="logo evolução informagem">
            <img id="logoName" src="../../src/imagens/name-logo/name-logo-m.png" alt="informagem">
            <img id="logoLamp" src="../../src/imagens/lampada-image/lampada-g .png" alt="lampada a gás simbolo da enfermagem">
        </a>

        <h1 id="infoblog">
            <span id="INFO">INFO</span><span id="blog">Blog</span>
        </h1>
    </header>

    <nav id="blogNav" class="center-flex" aria-label="Navegação do InfoBlog">
        <button id="filterBtn" class="center-flex"
        aria-controls="Options"
        aria-expanded="false">
            <span class="material-symbols-outlined" aria-hidden="true">filter_list</span>
            <span>Filtros</span>
            <span id="btnArrow" aria-hidden="true">▼</span>
        </button>
        
        <section id="Options" class="inactive" aria-label="Filtros e ordenação">
            <form class="filter-form center-flex">
                <fieldset>
                    <legend>Ordenar</legend>

                    <label>
                        <input type="radio" name="sort" value="mais recente" checked>
                        Mais recentes
                    </label>

                    <label>
                        <input type="radio" name="sort" value="menos recentes">
                        Menos recentes
                    </label>

                    <label>
                        <input type="radio" name="sort" value="mais relevantes">
                        Mais relevantes
                    </label>
                </fieldset>

                <fieldset class="filtros">
                    <legend>Filtros</legend>
                    <label>
                        <input type="checkbox" 
                        name="tag" 
                        value="teste"
                        checked>
                        Teste
                    </label>
                    <label>
                        <input type="checkbox" 
                        name="tag" 
                        value="enfermagem"
                        checked>
                        Enfermagem
                    </label>
                    <label>
                        <input type="checkbox" 
                        name="tag" 
                        value="informativo"
                        checked>
                        Informativo
                    </label>
                    <label>
                        <input type="checkbox"
                        name="tag" 
                        value="saude"
                        checked>
                        Saúde
                    </label>
                    <label>
                        <input type="checkbox" 
                        name="tag" 
                        value="cuidados"
                        checked>
                        Cuidados
                    </label>
                    <label>
                        <input type="checkbox" 
                        name="tag" 
                        value="prevencao"
                        checked>
                        Prevenção
                    </label>
                    <label>
                        <input type="checkbox" 
                        name="tag" 
                        value="prevencao2"
                        checked>
                        Prevenção2
                    </label>
                </fieldset>
            </form>
        </section>
        
        <div id="searchField" class="center-flex">
            <input id="searchInput" type="text" placeholder="Buscar no InfoBlog" aria-label="Campo de busca do blog">
            <button id="searchBtn">
                <span id="searchInputText">Buscar</span>
                <span id="searchInputIco" class="material-symbols-outlined" aria-hidden="true">search</span>
            </button>
            
        </div>
    </nav>


    <main class="paper-main">
        <div id="feedContainer">
            <h2>titulo do post</h2>
            <h3>subtitulos dos posts</h3>
            <p>texto do post   --- Lorem, ipsum dolor sit amet consectetur adipisicing elit. Dicta quia quasi laboriosam ab itaque aliquid natus a, odit ipsum asperiores eius quaerat voluptatibus autem aspernatur incidunt distinctio quam deleniti commodi. Lorem ipsum dolor sit amet consectetur adipisicing elit. Cumque at ullam quidem debitis accusamus fugit earum sapiente vitae fuga. Voluptate quae sequi distinctio quas quo esse consequuntur laborum! Quaerat, quo.</p>
            <img src="../../src/imagens/notebookImg.png" alt="">

            <div class="collection">
                <button id="backward"><</button>
                <button id="forward">></button>
                <div id="imagesContainer" class="center-flex">
                    <img src="../../src/imagens/notebookImg.png" alt="">

                    <div id="imgInfo"></div>
                </div>
            </div>
        </div>
    </main>

    <a id="btnVoltar"
    class="center-flex" 
    href="../../home.html">Voltar</a>
 
    <script type="module">
        import {switchMenu} from './JS/blogPageMenu.js'

        const btn = document.querySelector('#filterBtn')
        const container = document.querySelector('#Options')
        const icon = document.querySelector('#btnArrow')
        
        btn.addEventListener('click', () => {
            switchMenu(btn,container, icon)
        })
    </script>

    <script type="module">
        import { filterPosts } from './JS/filterPosts.js'
        import { renderPosts } from './JS/postsRender.js'
        import { search } from './JS/search.js'

        const postsJson = [
        {
            id: 'post-001',
            title: 'Primeiro Post',
            date: "2025-10-07T19:45:00Z",
            author: { name: "William Alves" },
            tags: ['teste', 'enfermagem'],
            content: [
            { type: "subtitle", value: "Subtítulo opcional" },
            { type: "text", value: "Lorem ipsum dolor sit amet..." },
            { type: 'img', value: ["../../src/imagens/notebookImg.png", "../../src/imagens/working.jpg.png", "../../src/imagens/enfermeiros/enfermeiro-p.png"] }
            ],
            references: null,
            meta: { views: 100 }
        },
        {
            id: 'post-002',
            title: 'Sinais Vitais: O que são e por que monitorar',
            date: '2025-10-05T19:45:00Z',
            author: { name: 'Enfermeiro IA' },
            tags: ['informativo', 'saude', 'cuidados'],
            content: [
            { type: 'img', value: ["./postImages/card1.png", "./postImages/card2.png", "./postImages/card3.png"] }
            ],
            references: null,
            meta: { views: 12 }
        },
        {
            id: 'post-003',
            title: 'Terceiro Post',
            date: "2025-10-04T19:45:00Z",
            author: { name: "Enfermeiro 2" },
            tags: ['prevencao', 'cuidados'],
            content: [
            { type: "text", value: "Lorem ipsum dolor sit amet..." },
            { type: 'img', value: ["../../src/imagens/notebookImg.png"] },
            { type: 'text', value: "possimus quae molestias expedita asperiores..." }
            ],
            references: [{ label: "OMS - História da Enfermagem", url: "https://www.who.int/" }],
            meta: { views: 30 }
        }
        ]

        const feedContainer = document.querySelector('#feedContainer')

        function updateFeed() {
            // 1. Filtra e ordena posts
            let result = filterPosts(postsJson)

            // 2. Aplica busca
            const query = searchInput.value.trim()
            if (query) {
                result = search(result, query)
            }

            // 3. Renderiza resultado final
            renderPosts(feedContainer, result)
        }

        const optionsContainer = document.getElementById('Options')

        optionsContainer.addEventListener('change', (event) => {
            const target = event.target
            if (target.matches('input[type="checkbox"][name="tag"], input[type="radio"][name="sort"]')) {
                updateFeed()
            } 
        })

        const searchInput = document.getElementById('searchInput')
        const searchBtn = document.getElementById('searchBtn')

        searchBtn.addEventListener('click', () => {
            updateFeed()
        })

        
        searchInput.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') updateFeed()
        })

        updateFeed()
    </script>
</body>
</html>